<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZEPHENHEL CITADEL</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="brand-badge">Z</div>
        <div class="brand-text">
          <h1>ZEPHENHEL CITADEL</h1>
          <p>Mythic tri-chain splitter • BSC • Ethereum • Polygon</p>
        </div>
      </div>

      <div class="pills">
        <div class="pill net" id="pillNet">Network: —</div>
        <div class="pill wallet" id="pillWallet">Wallet: Disconnected</div>

        <button class="btn ghost" id="btnSwitch">Switch Network</button>
        <button class="btn gold" id="btnConnect">Connect</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="tabs">
      <button class="tab active" data-tab="split">Splitter</button>
      <button class="tab" data-tab="vault">Inheritance Vault</button>
      <div class="fx">
        <label class="fx-toggle">
          <input type="checkbox" id="chkSound" checked />
          <span>Sound FX</span>
        </label>
      </div>
    </div>

    <section class="grid" id="tab-split">
      <!-- LEFT: Splitter inputs -->
      <div class="card">
        <div class="card-title">
          <h2>Split Command</h2>
          <span class="tag" id="tagSplitter">Splitter: —</span>
        </div>

        <div class="panel">
          <div class="label">Mode</div>
          <div class="seg">
            <button class="segbtn active" id="modeToken">Token Split (ERC20/BEP20)</button>
            <button class="segbtn" id="modeNative">Native Split (BNB/ETH/MATIC)</button>
          </div>

          <div class="hr"></div>

          <div id="tokenModeFields">
            <div class="label">Token address (ERC20/BEP20)</div>
            <input id="tokenAddress" placeholder="0x..." inputmode="text" spellcheck="false" />
            <div class="small dim">Tip: Use USDC/USDT/etc contract address on the selected chain.</div>
          </div>

          <div class="hr"></div>

          <div class="two">
            <div>
              <div class="label">Amount</div>
              <div class="amountRow">
                <input id="amount" placeholder="0.0" inputmode="decimal" />
                <button class="btn ghost mini" id="btnMax">MAX</button>
              </div>
              <div class="small dim" id="maxHint">MAX is for native only. For tokens, enter an amount.</div>
            </div>

            <div class="statbox">
              <div class="label">USD estimate</div>
              <div class="big" id="usdEstimate">$—</div>
              <div class="small dim" id="postFeeLine">You receive (post-fee): —</div>
              <div class="tiny dim" id="feeTiny">platform fee: <span class="goldtxt">1%</span></div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="card-title" style="margin-bottom:6px;">
            <h2>Recipients</h2>
            <div class="righttools">
              <span class="tag">Total: <span id="totalPct">100.00%</span></span>
              <button class="btn gold mini" id="btnAddRecipient">+ Add</button>
            </div>
          </div>

          <div id="recipients"></div>

          <div class="hr"></div>

          <div class="actions">
            <button class="btn ghost" id="btnApprove" disabled>Approve</button>
            <button class="btn gold" id="btnExecute" disabled>Execute Split</button>
          </div>

          <div class="notice" id="noticeAuto" style="margin-top:10px;">
            Citadel will <b>auto-detect</b> your splitter’s expected percent scale (100 / 10,000 / fee-adjusted) before sending.
          </div>

          <div class="error" id="errBox" style="display:none;margin-top:10px;"></div>
        </div>
      </div>

      <!-- RIGHT: Live data + log -->
      <div class="card">
        <div class="card-title">
          <h2>Live Telemetry</h2>
          <div class="righttools">
            <button class="btn ghost mini" id="btnRefresh">Refresh</button>
            <button class="btn ghost mini" id="btnClearLog">Clear</button>
          </div>
        </div>

        <div class="telemetry">
          <div class="tcard">
            <div class="label">Native balance</div>
            <div class="big" id="nativeBal">—</div>
          </div>
          <div class="tcard">
            <div class="label">Token symbol</div>
            <div class="big" id="tokenSym">—</div>
          </div>
          <div class="tcard">
            <div class="label">Token decimals</div>
            <div class="big" id="tokenDec">—</div>
          </div>
          <div class="tcard">
            <div class="label">Token balance</div>
            <div class="big" id="tokenBal">—</div>
          </div>
          <div class="tcard span2">
            <div class="label">Allowance → splitter</div>
            <div class="big" id="allowance">—</div>
            <div class="small dim" id="spenderAddr">—</div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="label">Runtime log</div>
        <div class="log" id="log"></div>

        <div class="footer-note">Always test small amounts first.</div>
      </div>
    </section>

    <!-- Vault tab -->
    <section class="grid" id="tab-vault" style="display:none;">
      <div class="card">
        <div class="card-title">
          <h2>Inheritance Vault</h2>
          <span class="tag">Multi-chain</span>
        </div>

        <div class="notice">
          Your vault contracts are deployed, but the frontend needs the <b>Vault ABI</b> (function names) to call them.
          Paste the ABI from the explorer “Contract → ABI” section, then use the controls below.
        </div>

        <div class="hr"></div>

        <div class="label">Vault address (auto per network)</div>
        <input id="vaultAddress" placeholder="0x..." />

        <div class="label" style="margin-top:10px;">Vault ABI (JSON)</div>
        <textarea id="vaultAbi" rows="8" placeholder='[ { "inputs": ..., "name": "...", "type": "function" } ]'></textarea>

        <div class="hr"></div>

        <div class="label">Quick actions (appear once ABI loads)</div>
        <div class="small dim">Citadel will show detected functions after ABI parse.</div>

        <div id="vaultActions" class="vaultActions"></div>

        <div class="hr"></div>

        <div class="actions">
          <button class="btn gold" id="btnLoadVault" disabled>Load Vault Interface</button>
        </div>

        <div class="error" id="vaultErr" style="display:none;margin-top:10px;"></div>
      </div>

      <div class="card">
        <div class="card-title">
          <h2>Vault Log</h2>
          <div class="righttools">
            <button class="btn ghost mini" id="btnClearVaultLog">Clear</button>
          </div>
        </div>
        <div class="log" id="vaultLog"></div>
        <div class="footer-note">Vault automation depends on your contract’s ABI & rules.</div>
      </div>
    </section>
  </main>

  <!-- ethers v5 UMD -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZEPHENHEL CITADEL</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-badge">Z</div>
      <div>
        <div class="brand-title">ZEPHENHEL CITADEL</div>
        <div class="brand-sub">Mythic tri-chain splitter • BSC • Ethereum • Polygon</div>
      </div>
    </div>

    <div class="pillrow">
      <div id="netPill" class="pill">Network: —</div>
      <div id="acctPill" class="pill">Wallet: Disconnected</div>
      <button id="connectBtn" class="btn gold">Connect</button>
      <button id="switchBtn" class="btn">Switch Network</button>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <section class="card">
        <div class="card-h">Command</div>

        <label class="lbl">Select network</label>
        <select id="networkSel" class="in">
          <option value="bsc">BSC Mainnet</option>
          <option value="eth">Ethereum Mainnet</option>
          <option value="polygon">Polygon Mainnet</option>
        </select>

        <label class="lbl">Token address (ERC20 / BEP20) — leave blank for native coin</label>
        <input id="tokenAddr" class="in" placeholder="0x…" />

        <div class="row">
          <div class="col">
            <label class="lbl">Amount</label>
            <input id="amount" class="in" placeholder="0.0" inputmode="decimal" />
            <div id="gasHint" class="hint"></div>
          </div>
          <div class="col right">
            <button id="maxBtn" class="btn">MAX</button>
            <div class="mini">
              <div class="mini-h">USD estimate</div>
              <div id="usdEst" class="mini-v">—</div>
              <div class="mini-h">You receive (post-fee est)</div>
              <div id="postFeeAmt" class="mini-v">—</div>
              <div class="mini-h tiny">Platform fee: <span class="tiny">1%</span></div>
            </div>
          </div>
        </div>

        <div class="split"></div>

        <div class="row between">
          <div class="card-h">Recipients</div>
          <div class="pillrow">
            <div id="totalPill" class="pill">Total: 0%</div>
            <button id="addRecBtn" class="btn">+ Add</button>
          </div>
        </div>

        <div id="recList" class="recList"></div>

        <div class="row">
          <button id="approveBtn" class="btn">Approve</button>
          <button id="splitBtn" class="btn gold">Execute Split</button>
        </div>

        <div id="errBox" class="err" hidden></div>
        <div class="hint">
          Tip: Citadel will try multiple execution modes (fee-adjust + percent scaling + gas fallbacks) until one succeeds.
        </div>
      </section>

      <aside class="card">
        <div class="row between">
          <div class="card-h">Live status</div>
          <button id="liveBtn" class="btn">Refresh</button>
        </div>

        <div class="kv">
          <div class="k">Wallet balance</div>
          <div id="walletBal" class="v">—</div>

          <div class="k">Token symbol</div>
          <div id="tokSym" class="v">—</div>

          <div class="k">Decimals</div>
          <div id="tokDec" class="v">—</div>

          <div class="k">Token balance</div>
          <div id="tokBal" class="v">—</div>

          <div class="k">Allowance → splitter</div>
          <div id="allow" class="v">—</div>

          <div class="k">Active splitter contract</div>
          <div id="splitterAddr" class="v mono">—</div>
        </div>

        <div class="row between">
          <div class="card-h">Runtime log</div>
          <div class="pillrow">
            <label class="chk"><input id="soundToggle" type="checkbox" checked /> Sound FX</label>
            <button id="clearLogBtn" class="btn">Clear</button>
          </div>
        </div>
        <pre id="log" class="log"></pre>
        <div class="hint center">Always test small amounts first.</div>
      </aside>
    </div>
  </main>

  <script src="app.js"></script>
</body>
</html>

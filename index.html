<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZEPHENHEL CITADEL</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>

  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="brand-badge">Z</div>
        <div class="brand-text">
          <h1>ZEPHENHEL CITADEL</h1>
          <p>Mythic tri-chain splitter • BSC • Ethereum • Polygon</p>
        </div>
      </div>

      <div class="pills">
        <div class="pill net" id="pillNet">Network: —</div>
        <div class="pill wallet" id="pillWallet">Wallet: Disconnected</div>
        <button class="btn ghost" id="btnSwitch">Switch Network</button>
        <button class="btn gold" id="btnConnect">Connect</button>
      </div>
    </div>
  </header>

  <main class="container">

    <div class="warframe">
      <div class="scanlines"></div>
      <div class="gridlines"></div>
      <div class="gloworb a"></div>
      <div class="gloworb b"></div>

      <div class="grid">
        <!-- LEFT: Split Command -->
        <section class="card">
          <div class="card-title">
            <h2>Split Command</h2>
            <div class="badge">Splitter</div>
          </div>

          <div class="label">Chain</div>
          <select id="selChain">
            <option value="bsc">BSC Mainnet</option>
            <option value="eth">Ethereum Mainnet</option>
            <option value="polygon">Polygon Mainnet</option>
          </select>

          <div class="hr"></div>

          <div class="label">Mode</div>
          <select id="selMode">
            <option value="token">Token Split (ERC20/BEP20)</option>
            <option value="native">Native Split (BNB/ETH/MATIC)</option>
          </select>
          <div class="small" id="modeHint">Tip: Token split uses Approve → Execute.</div>

          <div class="hr"></div>

          <div id="tokenBlock">
            <div class="label">Token address (ERC20 / BEP20)</div>
            <input id="inpToken" placeholder="0x…" spellcheck="false" />
          </div>

          <div class="row2">
            <div>
              <div class="label">Amount</div>
              <input id="inpAmount" placeholder="0.0" inputmode="decimal" />
              <div class="small" id="gasHint">MAX is for native only. Tokens: enter amount.</div>
            </div>
            <div class="miniCard">
              <div class="miniTitle">USD estimate</div>
              <div class="miniValue" id="usdEst">—</div>
              <div class="miniSub" id="postFeeLine">You send (auto-detect) —</div>
              <div class="miniSub2">Platform fee: <span class="feeTiny">1%</span></div>
            </div>
          </div>

          <div class="btnRow">
            <button class="btn ghost" id="btnMax">MAX (gas-safe)</button>
            <button class="btn ghost" id="btnNormalize">Normalize</button>
          </div>

          <div class="hr"></div>

          <div class="card-title" style="margin-bottom:6px;">
            <h2>Recipients</h2>
            <div class="inlineBtns">
              <div class="pill" id="totalPill">Total: 100%</div>
              <button class="btn ghost" id="btnAdd">+ Add</button>
            </div>
          </div>

          <div id="recipients"></div>

          <div class="btnRow">
            <button class="btn ghost" id="btnApprove">Approve</button>
            <button class="btn gold" id="btnExecute">Execute Split</button>
          </div>

          <div class="notice" id="tipBox">
            Citadel will auto-detect whether your splitter expects totals of 100 or 10,000
            AND whether it expects the amount BEFORE or AFTER the 1% fee.
          </div>

          <div class="error" id="errBox" style="display:none;"></div>

          <div class="footer-note">Always test small amounts first.</div>
        </section>

        <!-- RIGHT: Live Telemetry -->
        <section class="card">
          <div class="card-title">
            <h2>Live Telemetry</h2>
            <label class="soundToggle">
              <input type="checkbox" id="chkSound" checked />
              <span>Sound FX</span>
            </label>
          </div>

          <div class="teleGrid">
            <div class="teleBox">
              <div class="teleK">Native balance</div>
              <div class="teleV" id="teleNative">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Token symbol</div>
              <div class="teleV" id="teleSymbol">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Decimals</div>
              <div class="teleV" id="teleDecimals">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Token balance</div>
              <div class="teleV" id="teleTokenBal">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Allowance → splitter</div>
              <div class="teleV" id="teleAllowance">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Active splitter contract</div>
              <div class="teleV mono" id="teleSplitter">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Auto-detected mode</div>
              <div class="teleV" id="teleDetected">—</div>
            </div>
            <div class="teleBox">
              <div class="teleK">Status</div>
              <div class="teleV" id="teleStatus">Ready.</div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="card-title" style="margin-bottom:6px;">
            <h2>Runtime Log</h2>
            <div class="inlineBtns">
              <button class="btn ghost" id="btnRefresh">Refresh</button>
              <button class="btn ghost" id="btnClear">Clear</button>
            </div>
          </div>

          <pre class="log" id="log"></pre>

          <div class="footer-note">Citadel telemetry updates on connect, token load, approve, execute.</div>
        </section>
      </div>
    </div>

  </main>

  <script src="./app.js"></script>
</body>
</html>
